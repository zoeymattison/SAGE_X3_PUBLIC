SELECT
CONVERT(VARCHAR, SOH.CREDAT_0, 101) AS 'DATE CREATED',
SOH.STOFCY_0 AS 'SHIPMENT SITE',
SOH.SOHNUM_0 AS 'DELIVERY NUMBER',
CASE SOH.DRN_0
WHEN '1' THEN 'M'
WHEN '2' THEN '1'
WHEN '3' THEN '2'
WHEN '4' THEN '3'
WHEN '5' THEN '4'
WHEN '6' THEN '5'
WHEN '7' THEN '6'
WHEN '8' THEN '7'
WHEN '9' THEN '8'
WHEN '10' THEN '9'
WHEN '11' THEN 'C'
WHEN '12' THEN 'GAN'
WHEN '13' THEN 'RJH'
WHEN '14' THEN 'SKE'
WHEN '15' THEN '11'
WHEN '16' THEN '12'
WHEN '17' THEN '17'
WHEN '18' THEN '18'
WHEN '19' THEN '3T'
WHEN '20' THEN '1T'
WHEN '21' THEN '3TUI'
WHEN '22' THEN 'MOT'
WHEN '23' THEN 'PU'
WHEN '24' THEN 'OAK'
WHEN '25' THEN 'SID'
WHEN '26' THEN 'RLY'
WHEN '27' THEN 'FRT'
WHEN '28' THEN 'BOL'
WHEN '29' THEN 'BRD'
WHEN '30' THEN 'MAX'
WHEN '31' THEN 'OAK'
WHEN '32' THEN 'TSC'
WHEN '33' THEN 'ACE'
WHEN '34' THEN 'VSS'
WHEN '35' THEN '31'
WHEN '36' THEN 'DS'
WHEN '37' THEN 'MOW'
WHEN '38' THEN 'GEA'
WHEN '39' THEN 'SD'
WHEN '40' THEN '6S'
WHEN '41' THEN 'SSI'
WHEN '42' THEN 'QI'
WHEN '43' THEN 'PA'
WHEN '44' THEN 'CoC'
WHEN '45' THEN 'IBF'
WHEN '46' THEN 'IBS'
WHEN '47' THEN 'PKW'
WHEN '48' THEN 'MIK'
END AS 'ROUTE',
CASE
WHEN SOH.DRN_0 = '2' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '3' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '4' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '5' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '6' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '7' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '8' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '9' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '10' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '14' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '18' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '20' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '21' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '24' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '25' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '26' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '27' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '28' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '29' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '31' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MONK DRIVER' 
WHEN SOH.DRN_0 = '30' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MAXIMUM' 
WHEN SOH.DRN_0 = '33' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'ACE COURIER'
WHEN SOH.DRN_0 = '48' AND SOH.SOHNUM_0 NOT LIKE 'STR%' THEN 'MIKUS TRANSPORT'
WHEN SOH.SOHNUM_0 LIKE 'STR%' THEN 'INFOPOS TRANSACTION'
WHEN SOH.DRN_0 = '23' THEN 'LOCAL PICKUP'
ELSE 'UNKNOWN'
END AS 'METHOD',
CASE
WHEN SOH.STOFCY_0 IN ('DC30','DC33','DC52') AND SOH.BETFCY_0 = 1 THEN 'COMMERCIAL'
WHEN SOH.STOFCY_0 ='DC31' AND SOH.BETFCY_0 = 1 THEN 'FURNITURE'
WHEN SOH.STOFCY_0 BETWEEN '1200' AND '2800' AND SOH.BETFCY_0 = 1 THEN 'RETAIL'
WHEN SOH.DRN_0 IN ('19','20','21','35') THEN 'FURNITURE'
WHEN SOH.BETFCY_0 = 2 THEN 'INTERSITE'
ELSE 'UNKNOWN'
END AS 'SOURCE',
SOH.BPDPOSCOD_0 AS 'POSTAL CODE',
SOH.BPDCTY_0 AS 'CITY'


FROM LIVE.SORDER SOH

WHERE SOH.CREDAT_0 BETWEEN '20240401' AND '20240831'

ORDER BY SOH.CREDAT_0, SOH.STOFCY_0 ASC